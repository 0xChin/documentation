---
sidebar_position: 2
title: Pool
id: sdk-pool
---
# Class: NxtpSdkPool

**`Classdesc`**

SDK class encapsulating stableswap pool functions.

**`Remarks`**

This class will either interact with internal StableSwapFacet pools or external StableSwap pools
     depending on which type of pool is being used for each asset.
     Note: SDK currently only supports internal StableSwapFacet pools.

## Hierarchy

- [`NxtpSdkShared`](./sdk-shared)

  ↳ **`NxtpSdkPool`**

## Methods

### addLiquidity

▸ **addLiquidity**(`domainId`, `tokenAddress`, `amounts`, `minToMint?`, `deadline?`): `Promise`<`TransactionRequest`\>

Prepares the transaction request for adding liquidity to a pool.

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
| `domainId` | `string` | `undefined` | The domain ID of the pool. |
| `tokenAddress` | `string` | `undefined` | The address of local or adopted token. |
| `amounts` | `string`[] | `undefined` | The amounts of the tokens to swap. |
| `minToMint` | `string` | `"0"` | (optional) The minimum acceptable amount of LP tokens to mint. |
| `deadline` | `number` | `undefined` | (optional) The deadline for the swap. |

#### Returns

`Promise`<`TransactionRequest`\>

providers.TransactionRequest object.

___

### approveIfNeeded

▸ **approveIfNeeded**(`domainId`, `assetId`, `amount`, `infiniteApprove?`): `Promise`<`undefined` \| `TransactionRequest`\>

Returns the transaction request for an allowance approval.

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
| `domainId` | `string` | `undefined` | The domain ID. |
| `assetId` | `string` | `undefined` | The address of the token. |
| `amount` | `string` | `undefined` | The amount of the token. |
| `infiniteApprove` | `boolean` | `true` | (optional) Whether to approve an infinite amount. |

#### Returns

`Promise`<`undefined` \| `TransactionRequest`\>

providers.TransactionRequest object.

#### Inherited from

[NxtpSdkShared](./sdk-shared).[approveIfNeeded](sdk-shared#approveifneeded)

___

### calculateAddLiquidityPriceImpact

▸ **calculateAddLiquidityPriceImpact**(`domainId`, `tokenAddress`, `amountX`, `amountY`): `Promise`<`undefined` \| `BigNumber`\>

Calculates the price impact of adding liquidity to a pool.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |
| `amountX` | `string` | The amount of token X (index 0 of the pool). |
| `amountY` | `string` | The amount of token Y (index 1 of the pool). |

#### Returns

`Promise`<`undefined` \| `BigNumber`\>

Price impact for adding liquidity.

___

### calculateAmountReceived

▸ **calculateAmountReceived**(`originDomain`, `destinationDomain`, `originTokenAddress`, `amount`, `receiveLocal?`): `Promise`<{ `amountReceived`: `BigNumberish` ; `destinationSlippage`: `BigNumberish` ; `originSlippage`: `BigNumberish` ; `routerFee`: `BigNumberish`  }\>

Calculates the estimated amount received on the destination domain for a bridge transaction.

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
| `originDomain` | `string` | `undefined` | The domain ID of the origin chain. |
| `destinationDomain` | `string` | `undefined` | The domain ID of the destination chain. |
| `originTokenAddress` | `string` | `undefined` | The address of the token to be bridged from origin. |
| `amount` | `BigNumberish` | `undefined` | The amount of the origin token to bridge, in the origin token's native decimal precision. |
| `receiveLocal` | `boolean` | `false` | (optional) Whether the desired destination token is the local asset ("nextAsset"). |

#### Returns

`Promise`<{ `amountReceived`: `BigNumberish` ; `destinationSlippage`: `BigNumberish` ; `originSlippage`: `BigNumberish` ; `routerFee`: `BigNumberish`  }\>

Estimated amount received for local/adopted assets, if applicable, in their native decimal precisions.

___

### calculateCanonicalKey

▸ **calculateCanonicalKey**(`domainId`, `canonicalId`): `string`

Returns the hash of the canonical ID + canonical domain.

**`Remarks`**

This key is used as the unique identifier for a canonical token, across all domains.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The canonical domain ID of the token. |
| `canonicalId` | `string` | The canonical ID of the token. |

#### Returns

`string`

#### Inherited from

[NxtpSdkShared](./sdk-shared).[calculateCanonicalKey](sdk-shared#calculatecanonicalkey)

___

### calculatePriceImpact

▸ **calculatePriceImpact**(`tokenInputAmount`, `tokenOutputAmount`, `virtualPrice?`, `isDeposit?`): `BigNumber`

Calculates the price impact depending on whether liquidity is being deposited or withdrawn.

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
| `tokenInputAmount` | `BigNumber` | `undefined` | The amount of inbound tokens (LP tokens for withdrawals, total tokens for deposits, dx for swaps). |
| `tokenOutputAmount` | `BigNumber` | `undefined` | The amount of outbound tokens (total tokens for withdrawals, LP tokens for deposits, dy for swaps). |
| `virtualPrice` | `BigNumber` | `undefined` | (optional) The current virtual price of the pool. |
| `isDeposit` | `boolean` | `true` | (optional) Whether this is a deposit or withdrawal. |

#### Returns

`BigNumber`

The price impact.

___

### calculateRemoveLiquidityPriceImpact

▸ **calculateRemoveLiquidityPriceImpact**(`domainId`, `tokenAddress`, `amountX`, `amountY`): `Promise`<`undefined` \| `BigNumber`\>

Returns the price impact of removing liquidity from a pool.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |
| `amountX` | `string` | The amount of token X (index 0 of the pool). |
| `amountY` | `string` | The amount of token Y (index 1 of the pool). |

#### Returns

`Promise`<`undefined` \| `BigNumber`\>

The price impact for removing liquidity.

___

### calculateRemoveSwapLiquidity

▸ **calculateRemoveSwapLiquidity**(`domainId`, `tokenAddress`, `amount`): `Promise`<`BigNumber`[]\>

Calculates the amounts of underlying tokens returned.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |
| `amount` | `string` | The amount of the LP token to burn on withdrawal. |

#### Returns

`Promise`<`BigNumber`[]\>

Array containing amount of each underlying token returned, in correct index order.

___

### calculateSwap

▸ **calculateSwap**(`domainId`, `tokenAddress`, `tokenIndexFrom`, `tokenIndexTo`, `amount`): `Promise`<`BigNumber`\>

Calculates the amount of tokens received on a swap.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |
| `tokenIndexFrom` | `number` | The index of the token to sell. |
| `tokenIndexTo` | `number` | The index of the token to buy. |
| `amount` | `BigNumberish` | The number of tokens to sell, in the "From" token's native decimal precision. |

#### Returns

`Promise`<`BigNumber`\>

Minimum amount received, in the "To" token's native decimal precision.

___

### calculateSwapPriceImpact

▸ **calculateSwapPriceImpact**(`domainId`, `amountX`, `tokenX`, `tokenY`): `Promise`<`BigNumber`\>

Calculates the price impact of a swap.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `amountX` | `string` | The amount of tokens to swap. |
| `tokenX` | `string` | The address of the token to swap from. |
| `tokenY` | `string` | The address of the token to swap to. |

#### Returns

`Promise`<`BigNumber`\>

The price impact for swapping.

___

### calculateTokenAmount

▸ **calculateTokenAmount**(`domainId`, `tokenAddress`, `amounts`, `isDeposit?`): `Promise`<`BigNumber`\>

Calculates the minimum LP token amount from deposits or withdrawals.

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
| `domainId` | `string` | `undefined` | The domain ID of the pool. |
| `tokenAddress` | `string` | `undefined` | The address of local or adopted token. |
| `amounts` | `string`[] | `undefined` | The amounts of the tokens to deposit/withdraw, in the correct index order. |
| `isDeposit` | `boolean` | `true` | (optional) Whether this is a deposit or withdrawal. |

#### Returns

`Promise`<`BigNumber`\>

Minimum LP tokens received.

___

### calculateYield

▸ **calculateYield**(`feesEarned`, `principal`, `days`): `Object`

Calculates apr and apy.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `feesEarned` | `number` | The total fees earned in the period. |
| `principal` | `number` | The principal amount at the start of the period. |
| `days` | `number` | The number of days to look back. |

#### Returns

`Object`

Object containing apr and apy.

| Name | Type |
| :------ | :------ |
| `apr` | `number` |
| `apy` | `number` |

___

### changeSignerAddress

▸ **changeSignerAddress**(`signerAddress`): `Promise`<`void`\>

Switches the signer address in the SDK config.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `signerAddress` | `string` | The new signer address. |

#### Returns

`Promise`<`void`\>

#### Inherited from

[NxtpSdkShared](./sdk-shared).[changeSignerAddress](sdk-shared#changesigneraddress)

___

### getAdopted

▸ **getAdopted**(`domainId`, `tokenAddress`): `Promise`<`string`\>

Reads the adopted token.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |

#### Returns

`Promise`<`string`\>

The adopted token.

___

### getAssetsData

▸ **getAssetsData**(): `Promise`<[`AssetData`](./sdk-types/#assetdata)[]\>

Fetches the list of registered assets.

#### Returns

`Promise`<[`AssetData`](./sdk-types/#assetdata)[]\>

Array of objects containing assets registered to the network.

#### Inherited from

[NxtpSdkShared](./sdk-shared).[getAssetsData](sdk-shared#getassetsdata)

___

### getAssetsDataByDomainAndKey

▸ **getAssetsDataByDomainAndKey**(`domainId`, `key`): `Promise`<`undefined` \| [`AssetData`](./sdk-types/#assetdata)\>

Retrieve the asset data for a specific domain and key.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID. |
| `key` | `string` | The canonical hash of the canonical token. |

#### Returns

`Promise`<`undefined` \| [`AssetData`](./sdk-types/#assetdata)\>

The object containing asset data.

#### Inherited from

[NxtpSdkShared](./sdk-shared).[getAssetsDataByDomainAndKey](sdk-shared#getassetsdatabydomainandkey)

___

### getCanonicalTokenId

▸ **getCanonicalTokenId**(`domainId`, `tokenAddress`): `Promise`<[`string`, `string`]\>

#### Parameters

| Name | Type |
| :------ | :------ |
| `domainId` | `string` |
| `tokenAddress` | `string` |

#### Returns

`Promise`<[`string`, `string`]\>

#### Inherited from

[NxtpSdkShared](./sdk-shared).[getCanonicalTokenId](sdk-shared#getcanonicaltokenid)

___

### getDefaultDeadline

▸ **getDefaultDeadline**(): `number`

Set to 1 hour from current time.

#### Returns

`number`

The default deadline, in unix time.

___

### getLPTokenAddress

▸ **getLPTokenAddress**(`domainId`, `tokenAddress`): `Promise`<`string`\>

Reads the LP token address of a pool.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |

#### Returns

`Promise`<`string`\>

The LP token address.

___

### getLPTokenSupply

▸ **getLPTokenSupply**(`domainId`, `lpTokenAddress`): `Promise`<`BigNumber`\>

Reads the LP token supply of a pool.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `lpTokenAddress` | `string` | The address of the LP token. |

#### Returns

`Promise`<`BigNumber`\>

The LP token supply.

___

### getPoolTokenAddress

▸ **getPoolTokenAddress**(`domainId`, `tokenAddress`, `index`): `Promise`<`string`\>

Reads the address of a pool token.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |
| `index` | `number` | The index of the pool token. |

#### Returns

`Promise`<`string`\>

The address of the token.

___

### getPoolTokenBalance

▸ **getPoolTokenBalance**(`domainId`, `tokenAddress`, `poolTokenAddress`): `Promise`<`BigNumber`\>

Reads the balance of a pool token.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |
| `poolTokenAddress` | `string` | The address of the pool token. |

#### Returns

`Promise`<`BigNumber`\>

The balance of the pool token.

___

### getPoolTokenIndex

▸ **getPoolTokenIndex**(`domainId`, `tokenAddress`, `poolTokenAddress`): `Promise`<`number`\>

Reads the index of a pool token.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of the token. |
| `poolTokenAddress` | `string` | The address of the pool token. |

#### Returns

`Promise`<`number`\>

The index of the pool token.

___

### getRepresentation

▸ **getRepresentation**(`domainId`, `tokenAddress`): `Promise`<`string`\>

Reads the representation (local or adopted) token.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |

#### Returns

`Promise`<`string`\>

The representation (local or adopted) token.

___

### getTokenPrice

▸ **getTokenPrice**(`tokenSymbol`): `Promise`<`any`\>

Fetches the current price of a token.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `tokenSymbol` | `string` | The symbol for the token. |

#### Returns

`Promise`<`any`\>

The price of the token.

___

### getTokenUserBalance

▸ **getTokenUserBalance**(`domainId`, `tokenAddress`, `userAddress`): `Promise`<`BigNumber`\>

Reads the token balance of an address.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID where the token exists. |
| `tokenAddress` | `string` | The address of the token. |
| `userAddress` | `string` | The address to get the balance of. |

#### Returns

`Promise`<`BigNumber`\>

The user's balance of the token.

___

### getUserPools

▸ **getUserPools**(`domainId`, `userAddress`): `Promise`<{ `info`: [`Pool`](./sdk-types/#pool) ; `lpTokenBalance`: `BigNumber` ; `poolTokenBalances`: `BigNumber`[]  }[]\>

Retrieves the Pools that a user has LP tokens for.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `userAddress` | `string` | The address of the user to get the pools for. |

#### Returns

`Promise`<{ `info`: [`Pool`](./sdk-types/#pool) ; `lpTokenBalance`: `BigNumber` ; `poolTokenBalances`: `BigNumber`[]  }[]\>

Array of Pool objects.

___

### getVirtualPrice

▸ **getVirtualPrice**(`domainId`, `tokenAddress`): `Promise`<`BigNumber`\>

Reads the virtual price of a pool.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |

#### Returns

`Promise`<`BigNumber`\>

The virtual price.

___

### getYieldStatsForDay

▸ **getYieldStatsForDay**(`domainId`, `tokenAddress`, `unixTimestamp`): `Promise`<`undefined` \| { `totalFeesFormatted`: `number` ; `totalLiquidityFormatted`: `number` ; `totalVolume`: `BigNumber` ; `totalVolumeFormatted`: `number`  }\>

Calculates the fees, liquidity, and volume of a pool for the 24 hours prior to the specified unix time.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of the user to get the pools for. |
| `unixTimestamp` | `number` | The unix time to look back 24 hours from. |

#### Returns

`Promise`<`undefined` \| { `totalFeesFormatted`: `number` ; `totalLiquidityFormatted`: `number` ; `totalVolume`: `BigNumber` ; `totalVolumeFormatted`: `number`  }\>

Object containing fees, liquidity, and volume, formatted in the pool token's native decimal precision.

___

### isNextAsset

▸ **isNextAsset**(`tokenAddress`): `Promise`<`undefined` \| `boolean`\>

Returns whether the specified token is a Connext-issued (local) token.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `tokenAddress` | `string` | The address of the token. |

#### Returns

`Promise`<`undefined` \| `boolean`\>

Boolean or undefined if the specified token is not registered.

#### Inherited from

[NxtpSdkShared](./sdk-shared).[isNextAsset](sdk-shared#isnextasset)

___

### parseConnextTransactionReceipt

▸ **parseConnextTransactionReceipt**(`transactionReceipt`): `any`

Parses a providers.TransactionReceipt for the logs.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `transactionReceipt` | `TransactionReceipt` | providers.TransactionReceipt object. |

#### Returns

`any`

Array of providers.Log objects.

#### Inherited from

[NxtpSdkShared](./sdk-shared).[parseConnextTransactionReceipt](sdk-shared#parseconnexttransactionreceipt)

___

### removeLiquidity

▸ **removeLiquidity**(`domainId`, `tokenAddress`, `amount`, `minAmounts?`, `deadline?`): `Promise`<`TransactionRequest`\>

Returns the transaction request for removing liquidity from a pool.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID of the pool. |
| `tokenAddress` | `string` | The address of local or adopted token. |
| `amount` | `string` | The amount of the token to swap. |
| `minAmounts` | `string`[] | (optional) The minimum acceptable amounts of each token to burn. |
| `deadline` | `number` | (optional) The deadline for the swap. |

#### Returns

`Promise`<`TransactionRequest`\>

providers.TransactionRequest object.

___

### swap

▸ **swap**(`domainId`, `tokenAddress`, `from`, `to`, `amount`, `minDy?`, `deadline?`): `Promise`<`TransactionRequest`\>

Returns the transaction request for performing a swap in a pool.

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
| `domainId` | `string` | `undefined` | The domain ID of the pool. |
| `tokenAddress` | `string` | `undefined` | The address of local or adopted token. |
| `from` | `string` | `undefined` | The address of the token to sell. |
| `to` | `string` | `undefined` | The address of the token to buy. |
| `amount` | `string` | `undefined` | The amount of the selling token to swap. |
| `minDy` | `number` | `0` | (optional) The minimum amount of the buying token to receive. |
| `deadline` | `number` | `undefined` | (optional) The deadline for the swap. |

#### Returns

`Promise`<`TransactionRequest`\>

providers.TransactionRequest object.

___

### create

▸ `Static` **create**(`_config`): `Promise`<[`NxtpSdkPool`](NxtpSdkPool.md)\>

Create a singleton instance of the NxtpSdkPool class.

#### Parameters

| Name | Type | Default value | Description |
| :------ | :------ | :------ | :------ |
| `_config` | `Object` | undefined | NxtpSdkConfig object. |
| `_config.chains` | `Record`<`string`, { providers: string[] }\> | undefined | Chain config, at minimum with providers for each chain. |
| `_config.signerAddress` | `string` | undefined| Signer address for transactions. |
| `_config.logLevel` | ``"fatal"`` \| ``"error"`` \| ``"warn"`` \| ``"info"`` \| ``"debug"`` \| ``"trace"`` \| ``"silent"`` | "info" | (optional) Logging severity level. |
| `_config.network` | ``"testnet"`` \| ``"mainnet"`` | "mainnet" | (optional) Blockchain environment to interact with. |

#### Returns

`Promise`<[`NxtpSdkPool`](NxtpSdkPool.md)\>

providers.TransactionRequest object.

@example:
```ts
import { NxtpSdkPool } from "@connext/nxtp-sdk";

const config = {
  "chains": {
    "6648936": { // the domain ID for Ethereum Mainnet
      "providers": ["https://rpc.ankr.com/eth"]
    },
    "1869640809": { // the domain ID for Optimism
      "providers": ["https://mainnet.optimism.io"]
    },
    "1886350457": { // the domain ID for Polygon
      "providers": ["https://polygon-rpc.com"]
    },
  },
  "signerAddress": "<wallet_address>",
}

const nxtpSdkPool = await NxtpSdkPool.create(config);
```

:::note

See the [Supported Chains](../../../resources/supported-chains) page for all domain IDs.

:::

___

### domainToChainName

▸ `Static` **domainToChainName**(`domainId`): `string`

Returns the chain name for a specified domain.

#### Parameters

| Name | Type | Description |
| :------ | :------ | :------ |
| `domainId` | `string` | The domain ID. |

#### Returns

`string`

The chain name.

#### Inherited from

[NxtpSdkShared](./sdk-shared).[domainToChainName](sdk-shared#domaintochainname)

___

### getBlockNumberFromUnixTimestamp

▸ `Static` **getBlockNumberFromUnixTimestamp**(`domainId`, `unixTimestamp`): `Promise`<`number`\>

#### Parameters

| Name | Type |
| :------ | :------ |
| `domainId` | `string` |
| `unixTimestamp` | `number` |

#### Returns

`Promise`<`number`\>

#### Inherited from

[NxtpSdkShared](./sdk-shared).[getBlockNumberFromUnixTimestamp](sdk-shared#getblocknumberfromunixtimestamp)
